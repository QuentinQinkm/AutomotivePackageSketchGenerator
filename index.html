<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Side Profile Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="smart-adjuster.css">
</head>

<body>
    <div class="app-container">
        <div class="content-wrapper">
            <aside class="layer-panel">


                <div class="layer-control-groups">
                    <div class="layer-controls active" data-layer-controls="chassis">
                        <div class="control-section">
                            <h3>Chassis</h3>
                            <div class="control-group">
                                <label for="tireDiameter">
                                    <span>Tire Diameter</span>
                                    <span class="value-display" id="tireDiameterVal">700mm</span>
                                </label>
                                <input type="range" id="tireDiameter" min="500" max="1000" value="700" step="10">
                            </div>

                            <div class="control-group">
                                <label for="wheelArchGap">
                                    <span>Wheel Arch Gap</span>
                                    <span class="value-display" id="wheelArchGapVal">50mm</span>
                                </label>
                                <input type="range" id="wheelArchGap" min="0" max="200" value="50" step="5">
                            </div>

                            <div class="control-group">
                                <label for="wheelBase">
                                    <span>Wheel Base</span>
                                    <span class="value-display" id="wheelBaseVal">2800mm</span>
                                </label>
                                <input type="range" id="wheelBase" min="2000" max="4000" value="2800" step="10">
                            </div>

                            <div class="control-group">
                                <label for="groundClearance">
                                    <span>Ground Clearance</span>
                                    <span class="value-display" id="groundClearanceVal">150mm</span>
                                </label>
                                <input type="range" id="groundClearance" min="100" max="400" value="150" step="10">
                            </div>

                            <div class="control-group">
                                <label for="floorThickness">
                                    <span>Floor Thickness</span>
                                    <span class="value-display" id="floorThicknessVal">100mm</span>
                                </label>
                                <input type="range" id="floorThickness" min="50" max="300" value="100" step="10">
                            </div>


                            <div class="control-group">
                                <label for="frontOverhang">
                                    <span>Front Overhang (from Front Axle)</span>
                                    <span class="value-display" id="frontOverhangVal">700mm</span>
                                </label>
                                <input type="range" id="frontOverhang" min="400" max="1500" value="700" step="10">
                            </div>

                            <div class="control-group">
                                <label for="rearOverhang">
                                    <span>Rear Overhang (from Rear Axle)</span>
                                    <span class="value-display" id="rearOverhangVal">700mm</span>
                                </label>
                                <input type="range" id="rearOverhang" min="400" max="1500" value="700" step="10">
                            </div>

                            <div class="control-group">
                                <label for="frontApproachAngle">
                                    <span>Front Approach Angle</span>
                                    <span class="value-display" id="frontApproachAngleVal">18°</span>
                                </label>
                                <input type="range" id="frontApproachAngle" min="0" max="60" value="18" step="1">
                            </div>

                            <div class="control-group">
                                <label for="rearDepartureAngle">
                                    <span>Rear Departure Angle</span>
                                    <span class="value-display" id="rearDepartureAngleVal">18°</span>
                                </label>
                                <input type="range" id="rearDepartureAngle" min="0" max="60" value="18" step="1">
                            </div>
                        </div>
                    </div>

                    <div class="layer-controls" data-layer-controls="driver">
                        <div class="control-section">
                            <h3>Seat Position</h3>
                            <div class="control-group">
                                <label for="hPointHeight">
                                    <span>H-Point Height (from Floor)</span>
                                    <span class="value-display" id="hPointHeightVal">280mm</span>
                                </label>
                                <input type="range" id="hPointHeight" min="100" max="500" value="280" step="10">
                            </div>

                            <div class="control-group">
                                <label for="hPointX">
                                    <span>H-Point X (from Front Axle)</span>
                                    <span class="value-display" id="hPointXVal">1300mm</span>
                                </label>
                                <input type="range" id="hPointX" min="500" max="2000" value="1300" step="10">
                            </div>
                        </div>

                        <div class="control-section">
                            <h3>Driver</h3>
                            <div class="control-group">
                                <label for="bodyReclineAngle">
                                    <span>Body Recline Angle (from Vertical)</span>
                                    <span class="value-display" id="bodyReclineAngleVal">28°</span>
                                </label>
                                <input type="range" id="bodyReclineAngle" min="10" max="70" value="28" step="1">
                            </div>

                            <div class="control-group">
                                <label for="hipPedalDistance">
                                    <span>Hip-Pedal X Distance</span>
                                    <span class="value-display" id="hipPedalDistanceVal">600mm</span>
                                </label>
                                <input type="range" id="hipPedalDistance" min="400" max="950" value="600" step="10">
                            </div>

                            <div class="control-group">
                                <label for="handHeight">
                                    <span>Hand Height (from Hip Y)</span>
                                    <span class="value-display" id="handHeightVal">300mm</span>
                                </label>
                                <input type="range" id="handHeight" min="-200" max="800" value="300" step="10">
                            </div>

                            <div class="control-group">
                                <label for="handDistanceX">
                                    <span>Hand Distance X (from Hip)</span>
                                    <span class="value-display" id="handDistanceXVal">400mm</span>
                                </label>
                                <input type="range" id="handDistanceX" min="100" max="800" value="400" step="10">
                            </div>

                            <div class="control-group">
                                <label for="mannequinHeight">
                                    <span>Driver Height</span>
                                </label>
                                <select id="mannequinHeight">
                                    <option value="160">160 cm</option>
                                    <option value="170" selected>170 cm</option>
                                    <option value="180">180 cm</option>
                                    <option value="190">190 cm</option>
                                </select>
                            </div>

                            <div class="control-group checkbox-group">
                                <label for="showMannequin">
                                    <span>Show Driver</span>
                                </label>
                                <input type="checkbox" id="showMannequin" checked>
                            </div>
                        </div>
                    </div>

                    <!-- Old Image Controls Removed -->
                </div>
            </aside>

            <main class="canvas-container">
                <div class="canvas-area" id="canvasArea">
                    <div class="image-overlay-wrapper" id="imageOverlayWrapper">
                        <div class="image-frame" id="imageFrame">
                            <img id="overlayImage" alt="Reference overlay">
                            <div class="resize-handle" id="resizeHandle"></div>
                        </div>
                    </div>
                    <svg id="carCanvas" viewBox="0 0 1920 1080" xmlns="http://www.w3.org/2000/svg">
                        <!-- Elements will be drawn here by JS -->
                        <g id="drawingGroup"></g>
                    </svg>
                    <div id="profileBarContainer">
                        <!-- Profiles will be rendered here by ProfileManager -->
                    </div>

                    <div id="profileControls">
                        <div id="createNewProfileBtn">New</div>
                        <div id="uploadProfileBtn">Upload Profile</div>
                        <div id="profileLimitMessage" class="profile-limit hidden">Reach 5 tabs limit</div>
                    </div>

                    <input type="file" id="loadProfileInput" accept=".json" style="display: none;">
                    <div id="alignTopBar" class="align-top-bar hidden">
                        <label for="alignWheelBaseInput" class="align-label">Wheelbase</label>
                        <div class="align-input-container">
                            <input type="number" id="alignWheelBaseInput" class="align-input" placeholder="mm"
                                step="10">
                            <span class="align-helper-text">Rounded to nearest 10mm</span>
                        </div>
                        <button type="button" id="alignConfirmBtn" class="align-confirm-btn" disabled>Confirm</button>
                    </div>
                    <div class="canvas-content" id="canvasContent">
                        <div class="bodyandhead-parent">
                            <div class="bodyandhead-icon" data-inline-svg="HumanFigure/BodyAndHead.svg"
                                aria-label="body and head"></div>
                            <div class="big-leg-icon" data-inline-svg="HumanFigure/Big Leg.svg" aria-label="big leg">
                            </div>
                            <div class="bigarm-icon" data-inline-svg="HumanFigure/BigArm.svg" aria-label="big arm">
                            </div>
                            <div class="small-leg-icon" data-inline-svg="HumanFigure/Small Leg.svg"
                                aria-label="small leg"></div>
                            <div class="small-arm-icon" data-inline-svg="HumanFigure/Small Arm.svg"
                                aria-label="small arm"></div>
                            <div class="hip-joint-parent">
                                <div class="hip-joint"></div>
                                <div class="elbow"></div>
                                <div class="shoulder-joint"></div>
                                <div class="knee"></div>
                                <div class="hand-anchor"></div>
                                <div class="bottom-foot"></div>
                                <div class="top-head"></div>
                                <div class="heel"></div>
                            </div>
                        </div>
                    </div>
                    <button type="button" id="alignCancelBtn" class="align-cancel hidden">Cancel</button>
                </div>
                <div class="controls-infill" aria-hidden="true"></div>
                <!-- Chassis Controls Overlay -->
                <div class="chassis-controls-overlay" id="chassisControls">
                    <!-- Row 1: 5 items -->
                    <div class="control-row">
                        <div class="smart-adjuster" data-param="wheelBase" data-label="Wheel Base" data-min="2000"
                            data-max="4000" data-step="10"></div>
                        <div class="smart-adjuster" data-param="tireDiameter" data-label="Tire Size" data-min="500"
                            data-max="1000" data-step="10"></div>
                        <div class="smart-adjuster" data-param="groundClearance" data-label="Ground Clearance"
                            data-min="100" data-max="400" data-step="10"></div>
                        <div class="smart-adjuster" data-param="floorThickness" data-label="Floor Thickness"
                            data-min="50" data-max="300" data-step="10"></div>
                        <div class="smart-adjuster" data-param="wheelArchGap" data-label="Wheel Arch Gap" data-min="0"
                            data-max="200" data-step="5"></div>
                    </div>
                    <!-- Row 2: 4 items -->
                    <div class="control-row">
                        <div class="smart-adjuster" data-param="frontApproachAngle" data-label="Front Approach"
                            data-min="0" data-max="60" data-step="1"></div>
                        <div class="smart-adjuster" data-param="frontOverhang" data-label="Front Overhang"
                            data-min="400" data-max="1500" data-step="10"></div>
                        <div class="smart-adjuster" data-param="rearDepartureAngle" data-label="Rear Departure"
                            data-min="0" data-max="60" data-step="1"></div>
                        <div class="smart-adjuster" data-param="rearOverhang" data-label="Rear Overhang" data-min="400"
                            data-max="1500" data-step="10"></div>
                    </div>
                </div>

                <!-- Driver Controls Overlay -->
                <div class="driver-controls-overlay hidden" id="driverControls">
                    <!-- Row 1: Seat Position -->
                    <div class="control-row">
                        <div class="smart-adjuster" data-param="hPointHeight" data-label="H-Point Height" data-min="100"
                            data-max="500" data-step="10"></div>
                        <div class="smart-adjuster" data-param="hPointX" data-label="H-Point X" data-min="500"
                            data-max="2000" data-step="10"></div>
                        <!-- Smart Toggle -->
                        <div class="smart-toggle on" id="showMannequinToggle">
                            <div class="toggle-label">Show Driver</div>
                            <div class="toggle-value">ON</div>
                        </div>
                    </div>
                    <!-- Row 2: Driver -->
                    <div class="control-row">
                        <div class="smart-adjuster" data-param="bodyReclineAngle" data-label="Body Recline"
                            data-min="10" data-max="70" data-step="1"></div>
                        <div class="smart-adjuster" data-param="hipPedalDistance" data-label="Hip-Pedal Dist"
                            data-min="400" data-max="950" data-step="10"></div>
                        <div class="smart-adjuster" data-param="handHeight" data-label="Hand Height" data-min="-200"
                            data-max="800" data-step="10"></div>
                        <div class="smart-adjuster" data-param="handDistanceX" data-label="Hand Dist X" data-min="100"
                            data-max="800" data-step="10"></div>
                        <div class="smart-adjuster" data-param="mannequinHeight" data-label="Driver Height"
                            data-min="160" data-max="190" data-step="10"></div>
                    </div>
                </div>

                <!-- Image Controls Overlay -->
                <div class="image-controls-overlay hidden" id="imageControls">
                    <!-- State 1: Upload -->
                    <div class="upload-state" id="imageUploadState">
                        <label class="smart-button upload-btn">
                            <div class="button-label">Drag or upload an image</div>
                            <input type="file" id="imageUploadInput" accept="image/*" hidden>
                        </label>
                    </div>

                    <!-- State 2: Edit -->
                    <div class="edit-state hidden" id="imageEditState">
                        <div class="control-row">
                            <div class="smart-adjuster" data-param="imageOpacity" data-label="Transparency" data-min="0"
                                data-max="100" data-step="5"></div>
                            <div class="smart-adjuster" data-param="imageRotation" data-label="Rotation" data-min="-45"
                                data-max="45" data-step="0.5"></div>
                            <div class="smart-adjuster" data-param="imageScale" data-label="Scale" data-min="25"
                                data-max="200" data-step="0.5" data-hide-value="true"></div>

                            <div class="smart-button" id="flipImageBtn">
                                <div class="button-label">Flip</div>
                            </div>
                            <div class="smart-button" id="alignImageBtn">
                                <div class="button-label">Align</div>
                            </div>

                            <div class="smart-button delete" id="deleteImageBtn">
                                <div class="button-label">Delete</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="profile-controls-overlay hidden" id="profileControlsOverlay">
                    <div class="control-row">
                        <div class="smart-button" id="profileResetBtn">
                            <div class="button-label">Reset Canvas</div>
                        </div>
                        <div class="smart-button" id="profileOverwriteBtn">
                            <div class="button-label">Overwrite Profile</div>
                        </div>
                        <div class="smart-button" id="profileDownloadBtn">
                            <div class="button-label">Download Profile</div>
                        </div>
                    </div>
                </div>
                <input type="file" id="overwriteProfileInput" accept=".json" hidden>

                <div class="layer-list">
                    <button class="layer-button active" data-layer="chassis">Chassis</button>
                    <button class="layer-button" data-layer="driver">Driver</button>
                    <button class="layer-button" data-layer="image">Image</button>
                    <button class="layer-button" data-layer="profile">Profile</button>
                </div>
            </main>
        </div>
    </div>
    <script type="module" src="src/main.js"></script>
</body>

</html>
